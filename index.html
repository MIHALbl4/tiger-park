<!DOCTYPE html>
<html lang="en">

<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Document</title>
    <script src="https://api-maps.yandex.ru/2.1/?apikey=7271aeed-6ae5-46a4-bb1e-71085eec111c&lang=ru_RU"
        type="text/javascript">
        </script>
    <link href="./dist/output.css" rel="stylesheet">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Montserrat:wght@400;500&display=swap" rel="stylesheet">
</head>

<body>
    <div class="widget">
        <section class="widget__row">
            <div class="box col1">
                <div class="box__label">
                    Адрес погрузки
                </div>
                <div class="box__value">
                    ул.Колобова 11
                </div>
            </div>
            <div class="arrows">
                <img src="./dist/img/arrow-right.svg" alt="">
                <img src="./dist/img/arrow-left.svg" alt="">
            </div>
            <div class="box col2">
                <div class="box__label">
                    Адрес погрузки
                </div>
                <div class="box__value">
                    ул.Колобова 11
                </div>
            </div>
        </section>
        <section class="widget__row">
            <div class="box col1">
                <div class="box__label">
                    Время заказа
                </div>
                <div class="box__value">
                    05.07.2023 13:30
                </div>
            </div>
            <div class="box col2o5">
                <div class="box__label">
                    Адрес погрузки
                </div>
                <div class="box__value">
                    ул.Колобова 11
                </div>
            </div>
        </section>
    </div>

    <div id="map" style="width: 600px; height: 400px" class=""></div>
</body>

<script src="./particles.js"></script>
<script type="text/javascript">
    let entity = undefined;
    let car_mode = undefined;
    let car_from = undefined;

    insertValues();

    document.querySelector('select[name="entity"]').addEventListener('change', function () {
        entity = document.querySelector('select[name="entity"]').value;
        insertValues();
    });

    document.querySelector('select[name="car_mode"]').addEventListener('change', function () {
        car_mode = document.querySelector('select[name="car_mode"]').value;
        insertValues();
    });

    document.querySelector('select[name="car_from"]').addEventListener('change', function () {
        car_from = document.querySelector('select[name="car_from"]').value;
        insertValues();
    });

    function insertValues() {
        function genTextHTML(obj) {
            let text = '<select name="car_from" id="car_from">';
            for (const [key, value] of Object.entries(obj)) {
                text += String(`<option value=${value}>${key}</option>`);
            }
            text += '</select>';
            return text;
        }

        if (entity != undefined && car_mode != undefined && car_from != undefined) {
            if (entity == 0) {
                if (car_mode == 0) {

                    if (car_mode == 0) document.querySelector('div[name="toPosition"]').innerHTML = genTextHTML(p0_0_0);
                    

                }
            }
        }
    }

    function initMap(from, to) {
        ymaps.ready(function () {
            var myMap = new ymaps.Map('map', {
                center: [45.2, 34.0],
                zoom: 6,
                controls: []
            });

            var searchControl = new ymaps.control.SearchControl({
                options: {
                    provider: 'yandex#search'
                }
            });

            myMap.controls.add(searchControl);


            var multiRoute = new ymaps.multiRouter.MultiRoute({
                referencePoints: [from, to]
            }, {
                editorDrawOver: false,
                editorMidPointsType: "way",
                reverseGeocoding: false
            });

            multiRoute.editor.start({
                addWayPoints: true,
                removeWayPoints: true,
                addMidPoints: true
            });

            multiRoute.events.add('update', function () {
                if (multiRoute.getActiveRoute() != null) {

                    var length = multiRoute.getActiveRoute().properties.get("distance");
                    var duration = multiRoute.getActiveRoute().properties.get('duration');
                    var points = multiRoute.getWayPoints().toArray();

                    console.log(length);
                    console.log(duration);
                    console.log(points);
                }
            });

            myMap.geoObjects.add(multiRoute);
        });
    }

    function ChangeWaitState(but) {
        inp = document.querySelector("#islotoftime");
        if (waitstate == false) {
            but.parentElement.className = 'box__price col-span-3 row-span-2 cursor-pointer';
            waitstate = true;
            inp.value = true;
        }
        else {
            but.parentElement.className = 'box col-span-3 row-span-2 cursor-pointer';
            waitstate = false;
            inp.value = false;
        }
    }

    function CarScreen() {
        carscreen.style.display = 'flex';
        mainpage.style.display = 'none';
    }

    function ChosenCar(obj) {
        currentCategory = document.querySelector(".box__menu__value");
        inp = document.querySelector("#vehicles");
        carname = obj.querySelector("#carname").innerHTML;
        carchar = obj.querySelector("#carchar").innerHTML
        document.querySelector("#cardata1").innerHTML = carchar;
        document.querySelector("#cardata2").innerHTML = carname;
        inp.value = [currentCategory.id, carname + " " + carchar];
        carscreen.style.display = 'none';
        mainpage.style.display = 'flex';
    }
</script>

</html>